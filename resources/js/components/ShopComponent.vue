<style type="text/css" scoped>
  .topbar-menu-area .topbar-menu .label-before.fa-mobile,
.topbar-menu-area .topbar-menu .label-before.fa-mobile,
.product-style-1 .product-info .product-name:hover,
.wrap-vertical-nav li a:hover,
.header-nav-section li>a:hover,
.topbar-menu-area .topbar-menu ul li a:hover,
.product-style-2 .product-info .product-name:hover span,
.product .product-info .product-name:hover span,
.wrap-footer-item .wrap-hotline-footer .phone-number,
.back-link-box  .list-back-link li a:hover,
.coppy-right-box .coppy-right-text a:hover,
.wrap-nav.horizontal-nav .link-term:hover,
.change-display-mode .display-mode:hover i::before,
.change-display-mode .display-mode.active i::before,
.ui-slider+p button:hover,
.vertical-list li a.active,
.center-section .wrap-search-form,
.wrap-login-item .form-item input[type="checkbox"] + span::after,
.post-footer .post-tags ul li,
.wrap-iten-in-cart .products-cart .product-name a:hover,
.summary .checkout-info .link-to-shop:hover,
.wrap-product-detail .detail-info .quantity-input input,
.widget-our-services .service a>i,
.product-style-1 .product-info .wrap-btn a,
.wrap-breadcrumb ul a:hover,
.center-section .wrap-search-form .wrap-list-cate .list-cate li:not(.level-0):hover{
  color: #ff2832;
}

.widget a:hover,
.product-list-style .advance-info .wrap-btn .btn:hover,
.product-list-style .advance-info .wrap-btn .btn:hover::before,
.product .product-info .product-rating .count-review:hover,
.product-list-style .advance-info .stock-info.in-stock p b,
.wrap-login-item .form-item .link-function:hover,
.wrap-articles article .info .post-attrs li a:hover,
.wrap-articles article .info .post-attrs li a.link-commnet-post:hover::before,
.wrap-articles article .info .post-name:hover .art-title,
.widget.search-post button[type=submit]:hover i,
.wrap-product-detail .detail-info .wrap-btn .btn:hover,
.wrap-product-detail .detail-info .wrap-btn .btn:hover::before,
.widget.filter-widget .vertical-list li a::after
{
  color: #ff2832 !important;
}

.product-style-1 .product-info .wrap-btn a::after,
.primary .menu-item.home-icon,
.center-section .wrap-search-form button,
.wrap-banner .banner-link,
.wrap-main-slide .slide-1 .btn-link,
.wrap-main-slide .slide-3 .btn-link,
.product-style-2 .product-thumnail .wrap-btn .function-link:hover,
.wrap-footer-content .wrap-function-info,
.wrap-newletter-footer .btn-submit,
.wrap-footer-item .social-network ul li a:hover,
.product-style-3 a.add-to-cart:hover,
.widget.filter-widget .inline-round li a:hover,
.widget.filter-widget .inline-round li a.active,
.wrap-login-item .form-item .btn,
.wrap-contacts .contact-box input[type="submit"],
.wrap-icon-box .icon-box-item i,
.aboutus-info.style-small-left .list-showups label input[type="radio"]:checked + span.check-box,
.wrap-pagination-info .page-numbers li .page-number-item.current,
.wrap-articles article .info a.btn-to-post:hover,
.checkout-info .btn-checkout,
.post-footer .comment-form fieldset.input-field input[type=submit],
.wrap-product-detail .advance-info .tab-control a.active,
#review_form_wrapper #review_form .comment-form p.form-submit input[type=submit],
.wrap-product-detail .detail-info .wrap-butons .add-to-cart:hover,
.wrap-product-detail .detail-info .quantity-input .btn:hover,
.summary-item .btn,
.choose-payment-methods .payment-method input[type=radio]:checked + span::before,
.main-info-area .right-section .wrap-icon-section.minicart .index{
  background: #ff2832;
}
.has-child-cate .toggle-control:hover::after,
.has-child-cate .toggle-control:hover::before,
.widget.filter-widget .vertical-list li a.btn-control:hover::before,
.product-list-style .advance-info .add-to-cart:hover,
.detail-media .flex-control-nav .owl-nav button:hover,
.wrap-iten-in-cart .products-cart .quantity .quantity-input .btn:hover,
.wrap-pagination-info .page-numbers li .page-number-item:hover{
  background: #ff2832 !important;
}
.flex-control-thumbs img.flex-active,
.wrap-product-detail .advance-info .tab-control a.active,
.wrap-product-detail .detail-info .quantity-input .btn:hover,
.wrap-product-detail .detail-info .wrap-butons .add-to-cart:hover,
.product-widget-style .thumbnnail a:hover img,
.choose-payment-methods .payment-method input[type=radio]:checked + span::before,
.wrap-demo-item-1:hover img,
.center-section .wrap-search-form{
  border-color: #ff2832;
}
.widget.widget-tag-clouds ul li a:hover,
.product-list-style .advance-info .add-to-cart:hover,
.product-style-3 a.add-to-cart:hover,
.widget.filter-widget .inline-round li a:hover,
.widget.filter-widget .inline-round li a.active,
.wrap-pagination-info .page-numbers li .page-number-item.current,
.wrap-pagination-info .page-numbers li .page-number-item:hover,
.aboutus-info.style-small-left .list-showups label input[type="radio"]:checked + span.check-box,
.wrap-articles article .info a.btn-to-post:hover,
.wrap-footer-content .wrap-function-info .fc-info-item{
  border-color: #ff3c45 !important;
}
.wrap-footer-content .wrap-function-info .fc-info-item .wrap-left-info .fc-desc{
  color: #ffc2c4 !important;
}
.cat-label 
{
  font-weight: 550!important;
    padding: 5px!important;
}
.row{
    background-color: #fff;
  }
  /** preloader Start **/
.preloader {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 999999999;
  width: 100%;
  height: 100%;
  background-color: #fff;
  overflow: hidden;
}
.preloader-inner {
  position: absolute;
  top: 50%;
  left: 50%;
  -webkit-transform: translate(-50%,-50%);
  -moz-transform: translate(-50%,-50%);
  transform: translate(-50%,-50%);
}
.preloader-icon {
  width: 100px;
  height: 100px;
  display: inline-block;
  padding: 0px;
}
.preloader-icon span {
  position: absolute;
  display: inline-block;
  width: 100px;
  height: 100px;
  border-radius: 100%;
  background:#ffffff;
  -webkit-animation: preloader-fx 1.6s linear infinite;
  animation: preloader-fx 1.6s linear infinite;
}
.preloader-icon span:last-child {
  animation-delay: -0.8s;
  -webkit-animation-delay: -0.8s;
}
@keyframes preloader-fx {
  0% {transform: scale(0, 0); opacity:0.5;}
  100% {transform: scale(1, 1); opacity:0;}
}
@-webkit-keyframes preloader-fx {
  0% {-webkit-transform: scale(0, 0); opacity:0.5;}
  100% {-webkit-transform: scale(1, 1); opacity:0;}
}
.hideme
{
  visibility: hidden!important;
}
/** preloader End **/
.main-site
{
    background: #f5f5f5;
}
.seperator-line
{
  border-top: 1px solid #f1f1f1;
    zoom: 1;
  padding:10px;
  margin-top:20px;
}

</style>
<template>
    <div class="container">
      <div class="wrap-breadcrumb">
        <ul>
          <li class="item-link"><a href="#" class="link">home</a></li>
          <li class="item-link"><span>Digital & Electronics</span></li>
        </ul>
      </div>
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-xs-12 main-content-area">
          <div class="banner-shop">
            <a href="#" class="banner-link">
              <figure><img src="assets/images/shop-banner.jpg" alt=""></figure>
            </a>
          </div>
          <div class="wrap-shop-control">
            <h1 class="shop-title">Digital & Electronics title</h1>
            <div class="wrap-right">
              <div class="sort-item orderby ">
                <select name="orderby" class="use-chosen" id="sorting-items" v-model="selected.sortperitem">
                  <option value="default" selected="selected">Default sorting</option>
                  <option value="newness">Sort by newness</option>
                  <option value="price-asc">Sort by price: low to high</option>
                  <option value="price-desc">Sort by price: high to low</option>
                </select>
              </div>
              <div class="sort-item product-per-page">
                <select name="post-per-page" class="use-chosen" @change="sortpage()" v-model="selected.sortperpage">
                  <option value="12" selected="selected">12 per page</option>
                  <option value="16">16 per page</option>
                  <option value="18">18 per page</option>
                  <option value="21">21 per page</option>
                  <option value="24">24 per page</option>
                  <option value="30">30 per page</option>
                  <option value="32">32 per page</option>
                </select>
              </div>
              <div class="change-display-mode">
                <a href="#" class="grid-mode display-mode active"><i class="fa fa-th"></i>Grid</a>
                <a href="list.html" class="list-mode display-mode"><i class="fa fa-th-list"></i>List</a>
              </div>
            </div>
          </div>
            <div class="seperator-line"></div>
          <div class="row">
            <div class="p-1">
              <ul class="product-list grid-products equal-container">
              <!-- foreach -->
              <li class="col-lg-3 col-md-4 col-sm-6 col-xs-6" v-for="product in products.data">
                <div class="product product-style-2 equal-elem ">
                  <div class="product-thumnail">
                    <a href="/shop" title="T-Shirt Raw Hem Organic Boro Constrast Denim">
                        <figure><img :src="product.image" width="800" height="800"></figure>
                      </a>
                    <div class="group-flash">
                      <span class="flash-item new-label" v-if="product.new === '1'">New</span>
                      <span class="flash-item bestseller-label" v-if="product.promo === '1'">Promo</span>
                      <span class="flash-item sale-label" v-if="product.sale === '1'">Sale</span>
                    </div>
                  </div>
                  <div class="product-info">
                      <a href="/shop" class="product-name"><span>{{ product.product_name }}</span>
                      <div class="wrap-price">
                        <ins>
                          <p class="product-price">â‚±{{ product.regular_price }}</p>
                        </ins>
                        <del>
                          <p class="product-price" v-if="product.sale_price !== '0.00'">
                           {{ product.sale_price}}
                          </p>
                        </del>
                      </div>
                      </a>
                    </div>
                </div>
              </li>
              </ul>
            </div>
          </div>
         <!-- pagination -->
         <div class="wrap-pagination-info">
         <pagination :data="this.products" @pagination-change-page="getResults" class="float-right"></pagination>
        </div>
        </div><!--end main products area-->

        <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12 sitebar">
          <div class="widget mercado-widget filter-widget brand-widget">
            <h2 class="widget-title">Categories</h2>
            <div class="widget-content">
              <ul class="list-style vertical-list list-limited" data-show="6">
               <!-- foreach category -->
                  <li v-for="(category, index) in categories" class="list-item" :class="{ 'default-hiden': index >= 7}" >
                    <input class="form-check-input filter-link" type="checkbox" :value="category.id" :id="'category'+index" v-model="selected.categories">
                    <label class="form-check-label cat-label" :for="'category' + index">
                        {{ category.category_name }} ({{ category.products_count }})
                    </label>
                  </li>
                  <!-- <li class="list-item default-hiden"><a class="filter-link " href="#">cat 2</a></li> -->
              <!-- end -->
                <li class="list-item"><a data-label='Show less<i class="fa fa-angle-up" aria-hidden="true"></i>' class="btn-control control-show-more" href="#">Show more<i class="fa fa-angle-down" aria-hidden="true"></i></a></li>
              </ul>
            </div>
          </div>

          <div class="widget mercado-widget widget-product">
            <h2 class="widget-title">New Products</h2>
            <div class="widget-content">
              <ul class="products">
                <!-- foreach new products -->
                <li class="product-item">
                  <div class="product product-widget-style">
                    <div class="thumbnnail">
                      <a href="detail.html" title="Radiant-360 R6 Wireless Omnidirectional Speaker [White]">
                        <figure><img src="/images/products/default.png" alt=""></figure>
                      </a>
                    </div>
                    <div class="product-info">
                      <a href="#" class="product-name"><span>Product Name</span></a>
                      <div class="wrap-price"><span class="product-price">$168.00</span></div>
                    </div>
                  </div>
                </li>
                <!-- end -->
              </ul>
            </div>
          </div>

        </div>

      </div>

    </div>
</template>
<script>
    export default {
       data() {
            return {
                // prices: [],
                categories: [],
                products: {},
                loading: true,
                selected: {
                    categories: [],
                    sortperpage: '12',
                    sortperitem: 'default'
                },
            }
        },
        mounted() {
            this.loadProducts();
            this.loadCategories();
        },
         watch: {
            selected: {
                handler: function () {
                    this.loadProducts();
                },
                deep: true
            },
            sortperpage: {
                handler: function () {
                    this.loadProducts();
                },
                deep: true
            }
        },
        methods: {
          sortpage() {
                return this.selected.sortperpage
            },
          loadCategories: function () {
                axios.get('/api/category/get/list', {
                        params: _.omit(this.selected, 'categories')
                    })
                    .then((response) => {
                        this.categories = response.data.data;
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            },
            loadProducts: function () {
              $('.preloader').css("visibility","");
                axios.get('/api/products/get/list', {
                        params: this.selected,
                    })
                    .then((response) => {
                        this.products = response.data;
                        $('.preloader').css("visibility","hidden");
                        this.loading = false;
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            },
            getResults(page = 1) {
              $('.preloader').css("visibility","");
              this.loading = true;
              axios.get('api/products/get/list?page=' + page, {
                params: this.selected, 
                sortparam: this.sortperpage
              })
                  .then(response => {
                      this.products = response.data;
                      this.loading = false;
                      $('.preloader').css("visibility","hidden");
                  });
          },
        }
    }
</script>
